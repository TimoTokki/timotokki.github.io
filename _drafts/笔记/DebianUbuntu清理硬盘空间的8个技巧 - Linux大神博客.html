<html>
<head>
  <title>Debian/Ubuntu清理硬盘空间的8个技巧 - Linux大神博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/275193; Windows/6.3.9600;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="14908"/>
<h1>Debian/Ubuntu清理硬盘空间的8个技巧 - Linux大神博客</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2016/3/17 20:29</i></td></tr>
<tr><td><b>标签：</b></td><td><i>减藏</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://www.linuxdashen.com/debianubuntu%e6%b8%85%e7%90%86%e7%a1%ac%e7%9b%98%e7%a9%ba%e9%97%b4%e7%9a%848%e4%b8%aa%e6%8a%80%e5%b7%a7"><i>http://www.linuxdashen.com/debianubuntu%e6%b8%85%e7%90%86%e7%a1%ac%e7%9b%98%e7%a9%ba%e9%97%b4%e7%9a%848%e4%b8%aa%e6%8a%80%e5%b7%a7</i></a></td></tr>
</table>
</div>
<br/>

<div><span><br/><div style="font-size: 16px"><div style="font-family:sans-serif;"><div style="font-family:'PT Sans', SimHei;color:rgb(0, 0, 0);font-size:14px;line-height:22px;background:rgb(239, 239, 239);"><div style="background-color:rgb(239, 239, 239);"><div><div><div><span><div style="background-color:rgb(249, 249, 249);"><div style="font-size:15px;color:rgb(10, 10, 10);line-height:24px;">
<p style="margin:0px 0px 20px;">在前一篇文章中，我介绍了如何在<a href="http://www.linuxdashen.com/ubuntu%e5%a6%82%e4%bd%95%e5%88%a0%e9%99%a4%e6%97%a7%e5%86%85%e6%a0%b8%e4%bb%a5%e8%8a%82%e7%ba%a6%e7%a1%ac%e7%9b%98%e7%a9%ba%e9%97%b4" style="background:transparent;text-decoration:none;color:rgb(51, 102, 153);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(51, 102, 153);" target="_blank">ubuntu系统上删除旧的Linux内核</a>以腾出硬盘空间．现在，我整合我所了解的其他清理硬盘空间的技巧，分享给大家．</p>
<h2 style="font-weight:500;font-family:'PT Sans';margin:0px 0px 16px;color:rgb(17, 77, 103);font-size:21px;padding-top:22px;"><strong style="color:rgb(199, 37, 65);font-weight:700;padding:2px 4px;background-color:rgb(238, 238, 238);">1. 删除残余的配置文件</strong></h2>
<p style="margin:0px 0px 20px;">通常Debian/Ubuntu删除软件包可以用两条命令</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo apt-get remove &lt;package-name&gt;

sudo apt-get purge &lt;package-name&gt;</pre>
<p style="margin:0px 0px 20px;">remove将会删除软件包，但会保留配置文件．purge会将软件包以及配置文件都删除．</p>
<p style="margin:0px 0px 20px;">找出系统上残余的配置文件</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">dpkg --list | grep &quot;^rc&quot;</pre>
<p style="margin:0px 0px 20px;"><img src="DebianUbuntu清理硬盘空间的8个技巧 - Linux大神博客_files/Image.png" type="image/png" alt="Debian/Ubuntu删除残余配置文件" height="148" style="max-width:100%;height:auto;border:0px;clear:both;display:block;margin:0px auto;" width="534"/></p>
<p style="margin:0px 0px 20px;">其中第一栏的<strong style="color:rgb(199, 37, 65);font-weight:700;padding:2px 4px;background-color:rgb(238, 238, 238);">rc</strong>表示软件包已经删除（<strong style="color:rgb(199, 37, 65);font-weight:700;padding:2px 4px;background-color:rgb(238, 238, 238);">R</strong>emove），但配置文件（<strong style="color:rgb(199, 37, 65);font-weight:700;padding:2px 4px;background-color:rgb(238, 238, 238);">C</strong>onfig-file）还在. 现在提取这些软件包的名称．</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">dpkg --list | grep &quot;^rc&quot; | cut -d &quot; &quot; -f 3</pre>
<p style="margin:0px 0px 20px;"><img src="DebianUbuntu清理硬盘空间的8个技巧 - Linux大神博客_files/Image [1].png" type="image/png" alt="Debian/Ubuntu删除残余配置文件" height="159" style="max-width:100%;height:auto;border:0px;clear:both;display:block;margin:0px auto;" width="479"/></p>
<p style="margin:0px 0px 20px;">删除这些软件包</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">dpkg --list | grep &quot;^rc&quot; | cut -d &quot; &quot; -f 3 | xargs sudo dpkg --purge</pre>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">(Reading database ... 64538 files and directories currently installed.)
Removing libapt-inst1.4:amd64 (0.8.16~exp12ubuntu10.11) ...
Purging configuration files for libapt-inst1.4:amd64 (0.8.16~exp12ubuntu10.11) ...
Removing libbind9-80 (1:9.8.1.dfsg.P1-4ubuntu0.6) ...
Purging configuration files for libbind9-80 (1:9.8.1.dfsg.P1-4ubuntu0.6) ...</pre>
<p style="margin:0px 0px 20px;">如果你只想删除某个软件包的配置文件，那么可以使用下面的命令</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo dpkg --purge &lt;package-name&gt;</pre>
<h2 style="font-weight:500;font-family:'PT Sans';margin:0px 0px 16px;color:rgb(17, 77, 103);font-size:21px;padding-top:22px;">2. 删除没有用的deb软件安装包</h2>
<p style="margin:0px 0px 20px;">通常我们用sudo apt-get install 命令安装软件包后，apt-get下载的deb安装包会保留在系统上．所以如果你经常安装软件，那么这些deb安装包会占据大量的空间．这些安装包在<strong style="color:rgb(199, 37, 65);font-weight:700;padding:2px 4px;background-color:rgb(238, 238, 238);">/var/cache/apt/archives</strong>目录下。在软件安装完成后，这些deb安装包就没什么用了。对于硬盘容量有限的服务器来说<strong style="color:rgb(199, 37, 65);font-weight:700;padding:2px 4px;background-color:rgb(238, 238, 238);">apt-get clean</strong>命令可以腾出很多空间。你可以输入下面的命令来查看/var/chace/apt/archives目录下deb安装包的总大小</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">du -sh /var/cache/apt/archives</pre>
<p style="margin:0px 0px 20px;">要删除这些deb包，只需要运行下面两个命令就行了．</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo apt-get clean
sudo apt-get autoclean</pre>
<h2 style="font-weight:500;font-family:'PT Sans';margin:0px 0px 16px;color:rgb(17, 77, 103);font-size:21px;padding-top:22px;">3. 删除孤儿软件包</h2>
<p style="margin:0px 0px 20px;">有时候，你用apt-get安装一个软件包时会自动安装其他的依赖．当你删除掉这个软件包时，这些依赖也就没有用处了．这些没有用的依赖包叫做孤儿软件包，可以用下面的命令删除</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo apt-get autoremove</pre>
<p style="margin:0px 0px 20px;">不过apt-get autoremove只会删除经apt-get自动安装的依赖包，而你自己手动安装的依赖包则不会被删除，这时我们可以用deborphan来彻底删除．</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo apt-get install deborphan</pre>
<p style="margin:0px 0px 20px;">列出孤儿软件包</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">deborphan</pre>
<p style="margin:0px 0px 20px;"><img src="DebianUbuntu清理硬盘空间的8个技巧 - Linux大神博客_files/Image [2].png" type="image/png" alt="Linux清理硬盘空间" height="130" style="max-width:100%;height:auto;border:0px;clear:both;display:block;margin:0px auto;" width="416"/></p>
<p style="margin:0px 0px 20px;">将它们删除</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">deborphan | xargs sudo apt-get purge -y</pre>
<h2 style="font-weight:500;font-family:'PT Sans';margin:0px 0px 16px;color:rgb(17, 77, 103);font-size:21px;padding-top:22px;">4. 删除过时的软件包</h2>
<p style="margin:0px 0px 20px;">所谓过时（obsolete）的软件包是指<strong style="color:rgb(199, 37, 65);font-weight:700;padding:2px 4px;background-color:rgb(238, 238, 238);">/etc/apt/sources.list</strong>源文件中没有任何一个软件源提供这个软件的deb安装包．也就是说这个软件包在软件源里找不到了，不被支持了．这可能是因为下面几个原因：</p>
<ul style="margin:0px 0px 0px 14px;padding:0px 0px 15px 14px;">
<li style="font-family:'PT Sans', SimHei;">上游开发者不维护这个软件，又没有人来接管这个软件的开发．所以Debian/Ubuntu的软件包维护人员决定将这个软件从软件源中删除．</li>
<li style="font-family:'PT Sans', SimHei;">这个软件成了孤儿，同时用户很少．所以它就从软件源里消失了．</li>
<li style="font-family:'PT Sans', SimHei;">这个软件有了一个新的名字，维护人员给它起了一个新的名字并保留旧软件包．</li>
</ul>
<p style="margin:0px 0px 20px;">因为这些过时的软件不会有安全更新了，而且搞不好会在软件升级过程中引来麻烦，所以我们需要将它们删除．首先找出哪些软件包是过时的</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo aptitude search ?obsolete</pre>
<p style="margin:0px 0px 20px;">我的输出结果</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">i linux-image-3.2.0-29-generic - Linux kernel image for version 3.2.0 on 64</pre>
<p style="margin:0px 0px 20px;">将它删除</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo apt-get purge linux-image-3.2.0-29-generic</pre>
<p style="margin:0px 0px 20px;">你也可以使用下面的命令将所有过时的软件包一下清除</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo  aptitude purge ~o</pre>
<p style="margin:0px 0px 20px;">不过需要注意的是，有些软件包虽然在软件源里找不到，但它并不是过时的软件包．比如你自己下载安装的ubuntu-tweak．ubuntu-tweak需要你从官网下载deb安装包，但不提供软件源．用上面这条命令会将这类软件包也删除．所以我建议使用apt-get purge，自己选择需要删除的软件包．</p>
<h2 style="font-weight:500;font-family:'PT Sans';margin:0px 0px 16px;color:rgb(17, 77, 103);font-size:21px;padding-top:22px;">5. 清理日志文件</h2>
<p style="margin:0px 0px 20px;">日志文件会变得越来越大，我们可以用ncdu工具来查看大日志文件．</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo apt-get install ncdu

sudo ncdu /var/log</pre>
<p style="margin:0px 0px 20px;"><img src="DebianUbuntu清理硬盘空间的8个技巧 - Linux大神博客_files/Image [3].png" type="image/png" alt="Linux清理硬盘空间" height="277" style="max-width:100%;height:auto;border:0px;clear:both;display:block;margin:0px auto;" width="551"/></p>
<p style="margin:0px 0px 20px;">从上图可以发现，shadowsocks.log占用了24.5MiB的硬盘空间，我们可以用下面的命令来清空这个日志文件的内容．</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo dd if=/dev/null of=/var/log/shadowsocks.log</pre>
<h2 style="font-weight:500;font-family:'PT Sans';margin:0px 0px 16px;color:rgb(17, 77, 103);font-size:21px;padding-top:22px;">6. baobab硬盘空间用量分析工具</h2>
<p style="margin:0px 0px 20px;">baobab是一个图形界面工具，可以帮助我们查找系统中哪个目录或文件占据了大量空间．在终端里运行下面的命令</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">baobab</pre>
<p style="margin:0px 0px 20px;"><img src="DebianUbuntu清理硬盘空间的8个技巧 - Linux大神博客_files/Image [4].png" type="image/png" alt="Linux清理硬盘空间" height="358" style="max-width:100%;height:auto;border:0px;clear:both;display:block;margin:0px auto;" width="507"/></p>
<p style="margin:0px 0px 20px;">从上图中可以发现，<a href="http://www.linuxdashen.com/thunderbird%e9%82%ae%e4%bb%b6%e5%ae%a2%e6%88%b7%e7%ab%af%e6%b7%bb%e5%8a%a0%e6%96%b0%e7%9a%84%e9%82%ae%e7%ae%b1%e8%b4%a6%e5%8f%b7" style="background:transparent;text-decoration:none;color:rgb(51, 102, 153);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(51, 102, 153);" target="_blank">thunerbird</a>里的邮件就有14.3GB的大小！还有chromuim浏览器，<a href="http://www.linuxdashen.com/ubuntu15-04%e5%ae%89%e8%a3%85spotify%e9%9f%b3%e4%b9%90%e6%92%ad%e6%94%be%e5%99%a8" style="background:transparent;text-decoration:none;color:rgb(51, 102, 153);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(51, 102, 153);" target="_blank">Spotify音乐播放器</a>，<a href="http://www.linuxdashen.com/ubuntu15-04%e5%ae%89%e8%a3%85google-chrome%e6%b5%8f%e8%a7%88%e5%99%a8" style="background:transparent;text-decoration:none;color:rgb(51, 102, 153);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(51, 102, 153);" target="_blank">谷歌浏览器</a>，缩略图，这些缓存（cache）也占用了不少空间．</p>
<p style="margin:0px 0px 20px;">其实我们也可以用上面所提到了ncdu工具来查看大容量目录和文件．比如查看/home/&lt;username&gt;/</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo ncdu /home/&lt;<span style="color:#008000;">username</span>&gt;</pre>
<p style="margin:0px 0px 20px;">不过用ncdu的话，每查看一个目录就要输入一次命令，建议在服务器上用ncdu，在桌面版本用图形化的baobab工具．</p>
<h2 style="font-weight:500;font-family:'PT Sans';margin:0px 0px 16px;color:rgb(17, 77, 103);font-size:21px;padding-top:22px;">7. 删除大容量软件包</h2>
<p style="margin:0px 0px 20px;">首先安装debian-goodies</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo apt-get install debian-goodies</pre>
<p style="margin:0px 0px 20px;">然后输入下面的命令</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">dpigs -H</pre>
<p style="margin:0px 0px 20px;">我的输出结果</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">441.0M texlive-latex-extra-doc
230.1M valgrind-dbg
200.6M chromium-browser
171.4M google-chrome-stable
153.4M linux-image-extra-3.19.0-39-generic
153.4M linux-image-extra-3.19.0-37-generic
151.5M maltego
144.8M wine1.7-amd64
140.6M metasploit-framework
137.4M wine1.7-i386</pre>
<p style="margin:0px 0px 20px;">接下来你就可以删除你不用的软件包了．上面的命令默认只会显示前10个结果，你可指定结果的个数，比如20个</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">dpigs -H --lines=20</pre>
<h2 style="font-weight:500;font-family:'PT Sans';margin:0px 0px 16px;color:rgb(17, 77, 103);font-size:21px;padding-top:22px;">8. 使用ubuntu-tweak来清理</h2>
<p style="margin:0px 0px 20px;">前往<a href="http://ubuntu-tweak.com/" style="background:transparent;text-decoration:none;color:rgb(51, 102, 153);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(51, 102, 153);" target="_blank">ubuntu-tweak官网</a>下载deb安装包，然后输入下面的命令安装．</p>
<pre style="overflow-x:auto;overflow:auto;color:rgb(0, 0, 0);font-family:monospace;line-height:19px;font-size:14px;padding:10px 10px 10px 18px;word-wrap:break-word;margin:18px 0px;clear:both;background-color:rgb(196, 217, 229);">sudo apt-get install gdebi

sudo gdebi ubuntu-tweak*.deb</pre>
<p style="margin:0px 0px 20px;">打开ubuntu tweak后，选择Janitor标签．在这里你可以清理应用程序的缓存，缩略图缓存，apt缓存，旧内核，没有用的软件包配置文件，以及孤儿软件包．</p>
<p style="margin:0px 0px 20px;"><img src="DebianUbuntu清理硬盘空间的8个技巧 - Linux大神博客_files/Image [5].png" type="image/png" alt="ubuntu tweak清理缓存" height="329" style="max-width:100%;height:auto;border:0px;clear:both;display:block;margin:0px auto;" width="686"/></p>
</div></div></span></div></div></div></div></div></div></div><br/></span>
</div></body></html> 