<html>
<head>
  <title>1. 理解size_t_深入理解C指针_红黑联盟读书频道</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/275193; Windows/6.3.9600;"/>
  <meta name="application-data:ANDROID_CLIP_TYPE" content="article"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="13666"/>
<h1>1. 理解size_t_深入理解C指针_红黑联盟读书频道</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2015/10/17 21:14</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2015/10/17 21:14</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://m.2cto.com/?host=www.2cto.com&src=http%3A%2F%2Fbook.2cto.com%2F201402%2F40243.html"><i>http://m.2cto.com/?host=www.2cto.com&amp;src=http%3A%2F%2Fbook.2cto.com%2F201402%2F40243.html</i></a></td></tr>
</table>
</div>
<br/>

<div><span style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="font-size: 16px"><div style="outline:0px;font-family:STHeiti-Light, 'Hiragino Sans GB', 'Microsoft Yahei', Arial;font-size:14px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;overflow-x:hidden;"><div style="outline:0px;font-family:STHeiti-Light, 'Hiragino Sans GB', 'Microsoft Yahei', Arial;font-size:14px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;overflow-x:hidden;"><div style="outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;background-color:rgb(251, 251, 251);"><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">指针是C 语言的一项核心特性，对于指针的掌握程度是区分C 语言新手与老手的重要标志。本书专门研究指针，旨在提供比其他图书更全面和深入的C 指针和内存管理知识。全书巨细靡遗地为读者展现了C 语言编程中最  </span><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;"><a href="http://m.2cto.com/?host=www.2cto.com&amp;src=http%3A%2F%2Funion.dangdang.com%2Ftransfer.php%3Fsys_id%3D1%26ad_type%3D10%26from%3DP-265681%26backurl%3Dhttp%253A%252F%252Fproduct.dangdang.com%252Fproduct.aspx%253Fproduct_id%253D23433106" style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:rgb(51, 51, 51);text-decoration:none;text-indent:0px;float:none;">立即去当当网订购</a></span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">size_t 类型表示C 中任何对象所能达到的最大长度。它是无符号整数，因为负数在这里没有意义。它的目的是提供一种可移植的方法来声明与</span><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;"><a href="http://m.2cto.com/?host=www.2cto.com&amp;src=http%3A%2F%2Fwww.2cto.com%2Fos%2F" style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:rgb(51, 51, 51);text-decoration:none;text-indent:0px;float:none;">系统</a></span><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">中可寻址的内存区域一致的长度。size_t 用做sizeof 操作符的返回值类型，同时也是很多函数的参数类型，包括malloc 和strlen。</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">在声明诸如字符数或者数组索引这样的长度变量时用size_t 是好的做法。它经常用于循环计数器、数组索引，有时候还用在指针算术运算上。</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">size_t 的声明是实现相关的。它出现在一个或多个标准头文件中，比如stdio.h 和stblib.h，典型的定义如下：</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">#ifndef __SIZE_T</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">#define __SIZE_T</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">typedef unsigned int size_t;</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">#endif</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">define 指令确保它只被定义一次。实际的长度取决于实现。通常在32 位</span><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;"><a href="http://m.2cto.com/?host=www.2cto.com&amp;src=http%3A%2F%2Fwww.2cto.com%2Fos%2F" style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:rgb(51, 51, 51);text-decoration:none;text-indent:0px;float:none;">系统</a></span><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">上它的长度是32 位，而在64 位系统上则是64 位。一般来说，size_t 可能的最大值是SIZE_MAX。</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">通常size_t 可以用来存放指针，但是假定size_t 和指针一样长不是个好主意。稍后的“使用sizeof 操作符和指针”会讲到，intptr_t 是更好的选择。</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">打印size_t 类型的值时要小心。这是无符号值，如果选错格式说明符，可能会得到不可靠的结果。推荐的格式说明符是%zu。不过，某些情况下不能用这个说明符， 作为替代，可以考虑%u 或%lu。</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">下面这个例子将一个变量定义为size_t，然后用两种不同的格式说明符来打印：</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">size_t sizet = -5;</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">printf(&quot;%d\n&quot;,sizet);</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">printf(&quot;%zu\n&quot;,sizet);</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">因为size_t 本来是用于表示正整数的，如果用来表示负数就会出问题。如果为其赋一个负数，然后用%d 和%zu 格式说明符打印，就得到如下结果：</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;"> </span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">-5</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">4294967291</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">%d 把size_t 当做有符号整数，它打印出-5 因为变量中存放的就是-5。%zu 把size_t 当做无符号整数。当-5 被解析为有符号数时，高位置为1，表示这个数是负数。当它被解析为无符号数时，高位的1 被当做2 的乘幂。所以在用%zu 格式说明符时才会看到那个大整数。</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">正数会正常显示，如下所示：</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">sizet = 5;</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">printf(&quot;%d\n&quot;,sizet); // 显示5</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">printf(&quot;%zu\n&quot;,sizet); // 显示5</span></div><div style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:17px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:28px;vertical-align:baseline;text-indent:2em;color:rgb(51, 51, 51);"><span style="margin:0px;padding:0px;border:0px;outline:0px;font-family:inherit;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;text-indent:0px;color:rgb(51, 51, 51);float:none;">因为size_t 是无符号的，一定要给这种类型的变量赋正数。</span></div></div></div></div></div></span>
</div></body></html> 